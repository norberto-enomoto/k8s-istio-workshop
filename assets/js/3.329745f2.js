(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{211:function(s,t){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAAAsCAIAAADka3H1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFRUlEQVRoge2XX0hTbRjAn3OOtKOzzXnmQo+a25mLiY0hIRqSmTBQYUhgiTHwoi7Dq278F4R4IaK33TXwpoJs7FhGISKSQdT0IpcQbmf+iZbTsTzq2PTYxfm+fX7usy/3vau+73t/V4ftfZ73eX7b++cQ8XgcMIggf3YB/ymwTZRgmyjBNlGCbaIE20TJr27T6/X29fX97Cq+FyJN983h4eG1tbXf5iAIlUplNpttNhtN08fKs7W1FQqFTp8+nYYa/yAejz979uzdu3exWIxl2cbGxoKCghTyZCCvLEFdXV1lZSUASJIUCoV4nhdFsa2t7VhJlEqlUqlMT4EAAJIkkSQ5NjYWCASuXbumVCpfvHgxMjJy69Ytkjz2wk2jTZqm1Wq1/KzRaGw228OHD+Xqw+Gw2+32+/00TZtMpqamJkmS+vv729vbOY6TQ+7evavX64uKikZHR7u7uwEgOUoUxaGhoa6urqysLEmS7ty5U1FRYbfbAWBmZmZ+fv7GjRs+n+/p06dra2sqlaqysrKmpoYgiCdPnkSj0Z2dHUEQuru7CYKw2+3FxcUAYLPZBgcHw+EwwzDHbfnH7ZskSUqStL+/DwD3799nGKazs/PmzZtfvnzheT4zM7O0tNTr9cqDNzc3l5eXLRbLwQzJUQzDqNXq5eVlAFhdXc3JyREEQR4sCALHcaIojoyMXLhw4fbt2w6H49WrV7OzswBAUdSHDx8MBkNHRwcANDc3GwyGxNQZGRnZ2dmp9JiamuOysbExOTlpMpkoilpZWfn48WNDQ8OJEyeUSmV9ff3c3JwkSWfPnk3YnJ+fz8vLy8/PT2Q4KspgMAQCAQAQBKG8vHx7e3tnZwcAAoEAx3Gzs7Msy1osFpIkdTpdVVWVx+ORE1IUdf78+ZMnTx6sMxqNulyu2tpahUKRQptpXOnPnz+fmJgAgP39/b29vTNnzly+fBkANjY29vb2enp6Dg6ORCJlZWWPHz9eXV1lWdbr9R76Yx4VxXHcmzdvAMDv91dXVweDwaWlJYZhYrFYUVGRx+Px+XydnZ2JEI1GIz8kL+RIJOJ0OktKSi5dupRay39jU96wvofke0xNTc25c+cAIBAIuN3upqYm+TwhCIKm6d7e3uQkRqPR6/VqNBqfzydvfwmOiqIoyuVy7e7uLi0tXb16NRgM+v1+URT1ej1JkgRBmM1mh8ORPFdGxp96//Tpk9PprKqqunjx4ne2/Bc5v/31P7nrZWVlyb8/wzALCwuPHj26fv06QRC5ubnRaDQSichnVCwWi8fjsmiLxTI9Pa3VavPz87Va7cFsR0WpVCq1Wu3xeHJychQKRXFx8fj4+NbWlnyaabXaxcXFRBJRFGmaPuQRAMLh8L179xoaGqxWa8r9wg/bN+12ezAYfPnyJQCwLFtYWMjz/Pb2djQadbvdDx48kIeZzeZQKPT27dtDy/zbUQaDYWZmRr6Tsiz7+fNnQRCMRiMAWK3Wzc3Nqamp3d3dcDjsdDqnp6eTy+N5nuM4vV4f+Z3UruFp3DcPkp2d3djY6HK5TCaTTqdrbW3leX5gYIAkSY7jrly5Ig9TKBSlpaXv379vaWlJTnJUlNFofP36dX19PQBQFKXT6dbX10+dOiXP63A4xsfHJyYmMjMzrVZrbW3tobSxWGxhYQEA5ubmEh+2tbWVl5cft810vQv9P/nV39P/XWCbKME2UYJtogTbRAm2iRJsEyXYJkqwTZRgmyjBNlGCbaIE20QJtokSbBMl2CZKsE2UYJsowTZRgm2iBNtECbaJEmwTJdgmSrBNlHwFGGA5ftmDV+4AAAAASUVORK5CYII="},212:function(s,t){s.exports="data:image/png;base64,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"},213:function(s,t){s.exports="data:image/png;base64,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"},214:function(s,t,a){s.exports=a.p+"assets/img/bookinfo_v1_v3_v2.d76ff3b4.gif"},215:function(s,t,a){s.exports=a.p+"assets/img/istio_kiali_graph.5f2d46a7.gif"},236:function(s,t,a){"use strict";a.r(t);var e=a(0),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"istio-bookinfo-application"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#istio-bookinfo-application"}},[s._v("#")]),s._v(" Istio - Bookinfo Application")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("Screencast: "),e("a",{attrs:{href:"https://asciinema.org/a/229605?autoplay=0&t=352",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://asciinema.org/a/229605?t=352"),e("OutboundLink")],1)])]),s._v(" "),e("p",[s._v("The Bookinfo application is broken into four separate microservices:")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("productpage")]),s._v(" - the productpage microservice calls the details and reviews\nmicroservices to populate the page.")]),s._v(" "),e("li",[e("code",[s._v("details")]),s._v(" - the details microservice contains book information.")]),s._v(" "),e("li",[e("code",[s._v("reviews")]),s._v(" - the reviews microservice contains book reviews. It also calls\nthe ratings microservice.")]),s._v(" "),e("li",[e("code",[s._v("ratings")]),s._v(" - the ratings microservice contains book ranking information\nthat accompanies a book review.")])]),s._v(" "),e("p",[s._v("There are 3 versions of the "),e("code",[s._v("reviews")]),s._v(" microservice:")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("Version "),e("code",[s._v("v1")]),s._v(" - doesn’t call the "),e("strong",[s._v("ratings service")]),s._v(".")]),s._v(" "),e("p",[e("img",{attrs:{src:a(211),alt:"Bookinfo v1",title:"Bookinfo v1"}})])]),s._v(" "),e("li",[e("p",[s._v("Version "),e("code",[s._v("v2")]),s._v(" - calls the ratings service, and displays each rating as 1 to 5\n"),e("strong",[s._v("black stars")]),s._v(".")]),s._v(" "),e("p",[e("img",{attrs:{src:a(212),alt:"Bookinfo v2",title:"Bookinfo v2"}})])]),s._v(" "),e("li",[e("p",[s._v("Version "),e("code",[s._v("v3")]),s._v(" - calls the ratings service, and displays each rating as 1 to 5\n"),e("strong",[s._v("red stars")]),s._v(".")]),s._v(" "),e("p",[e("img",{attrs:{src:a(213),alt:"Bookinfo v3",title:"Bookinfo v3"}})])])]),s._v(" "),e("p",[e("a",{attrs:{href:"https://istio.io/docs/examples/bookinfo/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Bookinfo"),e("OutboundLink")],1),s._v(" application architecture:")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/istio/istio.io/7bf371365e4a16a9a13c0e79355fe1eac7f8f99f/content/docs/examples/bookinfo/withistio.svg?sanitize=true",alt:"Application Architecture with Istio",title:"Application Architecture with Istio"}})]),s._v(" "),e("p",[s._v("Deploy the demo of "),e("a",{attrs:{href:"https://istio.io/docs/examples/bookinfo/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Bookinfo"),e("OutboundLink")],1),s._v(" application:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v("\n")])])]),e("hr"),s._v(" "),e("p",[s._v("Confirm all services and pods are correctly defined and running:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get svc,deployment,pods -o wide\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("NAME                  TYPE        CLUSTER-IP       EXTERNAL-IP   PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    AGE     SELECTOR\nservice/details       ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.103")]),s._v(".142.153   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9080")]),s._v("/TCP   4m21s   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("details\nservice/kubernetes    ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.1        "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/TCP    75m     "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nservice/productpage   ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.111")]),s._v(".62.53     "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9080")]),s._v("/TCP   4m17s   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("productpage\nservice/ratings       ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.110")]),s._v(".22.215    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9080")]),s._v("/TCP   4m20s   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ratings\nservice/reviews       ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".73.81     "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9080")]),s._v("/TCP   4m19s   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("reviews\n\nNAME                                   READY   UP-TO-DATE   AVAILABLE   AGE     CONTAINERS    IMAGES                                         SELECTOR\ndeployment.extensions/details-v1       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           4m21s   details       istio/examples-bookinfo-details-v1:1.8.0       "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("details,version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1\ndeployment.extensions/productpage-v1   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           4m16s   productpage   istio/examples-bookinfo-productpage-v1:1.8.0   "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("productpage,version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1\ndeployment.extensions/ratings-v1       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           4m20s   ratings       istio/examples-bookinfo-ratings-v1:1.8.0       "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ratings,version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1\ndeployment.extensions/reviews-v1       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           4m19s   reviews       istio/examples-bookinfo-reviews-v1:1.8.0       "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("reviews,version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v1\ndeployment.extensions/reviews-v2       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           4m18s   reviews       istio/examples-bookinfo-reviews-v2:1.8.0       "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("reviews,version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v2\ndeployment.extensions/reviews-v3       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           4m18s   reviews       istio/examples-bookinfo-reviews-v3:1.8.0       "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("reviews,version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("v3\n\nNAME                                      READY   STATUS    RESTARTS   AGE     IP            NODE                             NOMINATED NODE   READINESS GATES\npod/details-v1-68c7c8666d-pvrx6           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          4m21s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".1.20   pruzicka-k8s-istio-workshop-node03   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/elasticsearch-operator-sysctl-297j8   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          45m     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".2.8    pruzicka-k8s-istio-workshop-node02   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/elasticsearch-operator-sysctl-bg8rn   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          45m     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".1.10   pruzicka-k8s-istio-workshop-node03   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/elasticsearch-operator-sysctl-vwvbl   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          45m     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".0.8    pruzicka-k8s-istio-workshop-node01   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/productpage-v1-54d799c966-2b4ss       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          4m16s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".1.23   pruzicka-k8s-istio-workshop-node03   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/ratings-v1-8558d4458d-ln99n           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          4m20s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".1.21   pruzicka-k8s-istio-workshop-node03   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/reviews-v1-cb8655c75-hpqfg            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          4m19s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".1.22   pruzicka-k8s-istio-workshop-node03   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/reviews-v2-7fc9bb6dcf-snshx           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          4m18s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".2.19   pruzicka-k8s-istio-workshop-node02   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npod/reviews-v3-c995979bc-wcql9            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2     Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          4m18s   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".0.12   pruzicka-k8s-istio-workshop-node01   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),e("p",[s._v("Check the container details - you should see also container "),e("code",[s._v("istio-proxy")]),s._v(" next\nto "),e("code",[s._v("productpage")]),s._v(".")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl describe pod -l "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("productpage\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nContainers:\n  productpage:\n    Container ID:   docker://09597863ee7cdde548ddc1fe1990eed0fea4c28ca7d7a0aedc58af6918edafd6\n    Image:          istio/examples-bookinfo-productpage-v1:1.8.0\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  istio-proxy:\n    Container ID:  docker://7c411ca50317c307ac326e3dd27a598ff4fd00e53206f15acd8debf5e7b319d8\n    Image:         docker.io/istio/proxyv2:1.0.5\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),e("p",[s._v("The "),e("code",[s._v("kubectl logs")]),s._v(" command will show you the output of the envoy proxy:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl logs "),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get pod -l "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("productpage -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.items[0].metadata.name}"')]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" istio-proxy\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-02-21T08:23:21.009428Z     info    Version root@6f6ea1061f2b-docker.io/istio-1.0.5-c1707e45e71c75d74bf3a5dec8c7086f32f32fad-Clean\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-02-21T08:23:21.009468Z     info    Proxy role: model.Proxy"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ClusterID:"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(", Type:"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sidecar"')]),s._v(", IPAddress:"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.244.0.14"')]),s._v(", ID:"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"productpage-v1-54d799c966-vbm6k.default"')]),s._v(", Domain:"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default.svc.cluster.local"')]),s._v(", Metadata:map"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("string"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nil"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-02-21T08:23:21.009751Z     info    Effective config: binaryPath: /usr/local/bin/envoy\nconfigPath: /etc/istio/proxy\nconnectTimeout: 10s\ndiscoveryAddress: istio-pilot.istio-system:15007\ndiscoveryRefreshDelay: 1s\ndrainDuration: 45s\nparentShutdownDuration: 60s\nproxyAdminPort: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("15000")]),s._v("\nserviceCluster: productpage\nzipkinAddress: zipkin.istio-system:9411\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),e("p",[s._v("Define the "),e("a",{attrs:{href:"https://istio.io/docs/reference/config/networking/gateway/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Istio gateway"),e("OutboundLink")],1),s._v("\nfor the application:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" samples/bookinfo/networking/bookinfo-gateway.yaml\nkubectl apply -f samples/bookinfo/networking/bookinfo-gateway.yaml\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("apiVersion: networking.istio.io/v1alpha3\nkind: Gateway\nmetadata:\n  name: bookinfo-gateway\nspec:\n  selector:\n    istio: ingressgateway "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use istio default controller")]),s._v("\n  servers:\n  - port:\n      number: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      name: http\n      protocol: HTTP\n    hosts:\n    - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v("\n---\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: bookinfo\nspec:\n  hosts:\n  - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v("\n  gateways:\n  - bookinfo-gateway\n  http:\n  - match:\n    - uri:\n        exact: /productpage\n    - uri:\n        exact: /login\n    - uri:\n        exact: /logout\n    - uri:\n        prefix: /api/v1/products\n    route:\n    - destination:\n        host: productpage\n        port:\n          number: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9080")]),s._v("\n")])])]),e("p",[s._v("Confirm the gateway and virtualsevice has been created:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get gateway,virtualservice\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("NAME                                           AGE\ngateway.networking.istio.io/bookinfo-gateway   11s\n\nNAME                                          AGE\nvirtualservice.networking.istio.io/bookinfo   12s\n")])])]),e("p",[s._v("Determining the ingress IP and ports when using a node port:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("INGRESS_PORT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl -n istio-system get "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" istio-ingressgateway -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.spec.ports[?(@.name=='),e("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("http2"),e("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(')].nodePort}"')]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SECURE_INGRESS_PORT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl -n istio-system get "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" istio-ingressgateway -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("jsonpath")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{.spec.ports[?(@.name=='),e("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("https"),e("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(')].nodePort}"')]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("INGRESS_HOST")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl get po -l "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("istio")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ingressgateway -n istio-system -o "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jsonpath={.items[0].status.hostIP}"')]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -f "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/terraform.tfstate "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -q vms_public_ip "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/terraform.tfstate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("INGRESS_HOST")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("terraform output -json -state"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/terraform.tfstate "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('".vms_public_ip.value[0]"')]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GATEWAY_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$INGRESS_HOST")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$INGRESS_PORT")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$INGRESS_PORT")]),s._v(" | "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SECURE_INGRESS_PORT")]),s._v(" | "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$INGRESS_HOST")]),s._v(" | "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GATEWAY_URL")]),s._v(" | http://"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GATEWAY_URL")]),s._v('/productpage"')]),s._v("\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[s._v("31380")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("31390")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".242.170 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".242.170:31380 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" http://172.16.242.170:31380/productpage\n")])])]),e("p",[s._v("Point your browser to "),e("code",[s._v("http://$GATEWAY_URL/productpage")]),s._v("\n(take the full URL from the output of the commands above).")]),s._v(" "),e("hr"),s._v(" "),e("p",[s._v("Confirm the app is running:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -o /dev/null -s -w "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%{http_code}'),e("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" -A "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5"')]),s._v(" http://"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${GATEWAY_URL}")]),s._v("/productpage\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("\n")])])]),e("p",[s._v("Create default "),e("a",{attrs:{href:"https://istio.io/docs/reference/config/networking/destination-rule/",target:"_blank",rel:"noopener noreferrer"}},[s._v("destination rules"),e("OutboundLink")],1),s._v("\n(subsets) for the Bookinfo services:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl apply -f samples/bookinfo/networking/destination-rule-all.yaml\n")])])]),e("p",[s._v("Display the destination rules:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get destinationrules -o yaml\n")])])]),e("p",[s._v("Output:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n- apiVersion: networking.istio.io/v1alpha3\n  kind: DestinationRule\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n    name: reviews\n    namespace: default\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  spec:\n    host: reviews\n    subsets:\n    - labels:\n        version: v1\n      name: v1\n    - labels:\n        version: v2\n      name: v2\n    - labels:\n        version: v3\n      name: v3\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),e("p",[s._v("Generate some traffic for next 5 minutes to gather some data:")]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("siege --log"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/siege --concurrent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -q --internet --time"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("5M "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GATEWAY_URL")]),s._v("/productpage "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])]),e("p",[s._v("Open the browser with these pages:")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("Servicegraph:")]),s._v(" "),e("ul",[e("li",[e("p",[e("a",{attrs:{href:"http://localhost:8088/force/forcegraph.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:8088/force/forcegraph.html"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"http://localhost:8088/dotviz",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:8088/dotviz"),e("OutboundLink")],1)])])])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kiali"),e("OutboundLink")],1),s._v(":")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://localhost:20001",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:20001"),e("OutboundLink")],1),s._v(" (admin/admin)")])])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.jaegertracing.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jaeger"),e("OutboundLink")],1),s._v(":")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://localhost:16686",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:16686"),e("OutboundLink")],1)])])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://prometheus.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Prometheus"),e("OutboundLink")],1),s._v(":")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://localhost:9090/graph",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:9090/graph"),e("OutboundLink")],1)])])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://www.elastic.co/products/kibana",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kibana"),e("OutboundLink")],1),s._v(":")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://localhost:5601/app/kibana",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://localhost:5601/app/kibana"),e("OutboundLink")],1)])])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://grafana.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Grafana"),e("OutboundLink")],1),s._v(":")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://localhost:3000",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:3000"),e("OutboundLink")],1),s._v(" (Grafana -> Home -> Istio ->\nIstio Performance Dashboard, Istio Service Dashboard,\nIstio Workload Dashboard)")])])])]),s._v(" "),e("p",[s._v("Open the Bookinfo site in your browser "),e("code",[s._v("http://$GATEWAY_URL/productpage")]),s._v("\nand refresh the page several times - you should see different versions\nof reviews shown in productpage, presented in a "),e("strong",[s._v("round robin style")]),s._v("\n(red stars, black stars, no stars), since we haven’t yet used Istio to control\nthe version routing.")]),s._v(" "),e("p",[e("img",{attrs:{src:a(214),alt:"Bookinfo v1, v3, v2",title:"Bookinfo v1, v3, v2"}})]),s._v(" "),e("p",[s._v("Check the flows in "),e("a",{attrs:{href:"https://www.kiali.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kiali"),e("OutboundLink")],1),s._v(" graph:")]),s._v(" "),e("p",[e("img",{attrs:{src:a(215),alt:"Istio Graph",title:"Istio Graph"}})]),s._v(" "),e("hr"),s._v(" "),e("p",[e("img",{attrs:{src:a(57),alt:"Istio",title:"Istio"}})])])}),[],!1,null,null,null);t.default=r.exports},57:function(s,t,a){s.exports=a.p+"assets/img/istio.a24267ed.svg"}}]);